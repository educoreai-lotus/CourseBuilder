# How to Test AI Course Structure Generation

## ğŸ¯ Quick Test: Create a Course via API

To see AI-generated topics and modules, you need to create a course through the API endpoint (not the seed script).

### Step 1: Make sure your server is running

```powershell
cd C:\Users\HP\Desktop\MainDevelopment_tamplates\backend
npm run dev
```

### Step 2: Create a course via API

Use this curl command or Postman:

```bash
curl -X POST http://localhost:3000/api/v1/courses/input \
  -H "Content-Type: application/json" \
  -H "x-role: service" \
  -H "x-user-role: service" \
  -d '{
    "learner_id": "10000000-0000-0000-0000-000000000001",
    "learner_name": "Alice Learner",
    "learner_company": "Emerald Learning",
    "learning_path": [
      {
        "topic_name": "JavaScript Fundamentals",
        "topic_description": "Learn JavaScript basics and core concepts"
      },
      {
        "topic_name": "React Development",
        "topic_description": "Build modern React applications"
      }
    ],
    "skills": ["javascript", "react", "frontend"],
    "level": "beginner",
    "duration": 10,
    "metadata": {
      "learner_id": "10000000-0000-0000-0000-000000000001",
      "learner_company": "Emerald Learning"
    }
  }'
```

### Step 3: Check the Response

The response will include:

```json
{
  "status": "accepted",
  "course_id": "uuid-here",
  "structure": {
    "topics": 4,
    "modules": 8,
    "lessons": 15,
    "structureSource": "ai-generated"  // âœ… This shows AI was used!
  }
}
```

### Step 4: Verify AI Usage

Run the check script with the course ID from the response:

```powershell
npm run check:ai-structure <course-id-from-response>
```

You should now see:
- âœ… `Source: ai-generated`
- âœ… `Generated By: ai`
- âœ… Meaningful topic names (not "Topic 1", "Topic 2")

---

## ğŸ” What Happens During AI Course Creation

1. **API receives request** â†’ `POST /api/v1/courses/input`
2. **Controller** â†’ Calls `generateStructure()` service
3. **Fetch lessons** â†’ Gets lessons from Content Studio for each topic
4. **AI analyzes** â†’ OpenAI analyzes all lessons and groups them into topics/modules
5. **Create structure** â†’ Topics and modules are created with AI-generated names
6. **Store metadata** â†’ AI info saved in `learning_path_designation`:
   ```json
   {
     "structure_source": "ai-generated",
     "structure_generated_by": "ai",
     "total_topics": 4,
     "total_modules": 8,
     "generated_at": "2025-12-02T..."
   }
   ```

---

## ğŸ“Š Difference: Seed Script vs AI Generation

| Aspect | Seed Script (`seedMockData.js`) | AI Generation (`/api/v1/courses/input`) |
|--------|--------------------------------|--------------------------------|
| **Topic Names** | Hardcoded in script | Generated by AI |
| **Module Names** | Hardcoded in script | Generated by AI |
| **AI Metadata** | âŒ Not set (shows "unknown") | âœ… Set (shows "ai-generated") |
| **Purpose** | Testing with sample data | Real course creation |

---

## âœ… Expected Result After API Course Creation

When you check a course created via API:

```
ğŸ“š Course: [AI-Generated Course Name]
   Type: learner_specific

   ğŸ¤– AI Status:
      Source: ai-generated          âœ…
      Generated By: ai              âœ…
      Generated At: 2025-12-02...   âœ…
      âœ… AI SUCCESSFULLY GENERATED STRUCTURE

   ğŸ“Š Structure Summary:
      Topics: 4
      Modules: 8
      Lessons: 15

   ğŸ“– Topics Created:
      âœ… 1. Introduction to JavaScript Fundamentals
      âœ… 2. Advanced React Patterns
      âœ… 3. State Management Strategies
      âœ… 4. Performance Optimization
```

---

## ğŸš¨ Troubleshooting

If `structure_source` is still "fallback" after API creation:

1. **Check OpenAI API Key:**
   ```powershell
   # In backend/.env file
   OPENAI_API_KEY=sk-...  # Must be set
   ```

2. **Check server logs** for:
   - `[AI Structure Generator] Calling OpenAI...`
   - Any OpenAI API errors

3. **Verify Content Studio is working:**
   - Look for: `[Course Structure] Total lessons fetched: X`
   - If X is 0, Content Studio isn't returning lessons

4. **Check OpenAI account:**
   - Ensure you have credits
   - Check for rate limiting
